!function(){"use strict";var t=function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")},n=function(){function t(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(n,e,r){return e&&t(n.prototype,e),r&&t(n,r),n}}(),e=function(t,n){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?t:n},r=function(){function e(n,r,i,o){t(this,e),this.name=n,this.fn=r,this.args=i,this.modifiers=o}return n(e,[{key:"_test",value:function(t){var n=this.fn;try{o(this.modifiers.slice(),n)(t)}catch(t){n=function(){return!1}}try{return o(this.modifiers.slice(),n)(t)}catch(t){return!1}}},{key:"_check",value:function(t){try{o(this.modifiers.slice(),this.fn)(t)}catch(t){if(o(this.modifiers.slice(),(function(t){return t}))(!1))return}if(!o(this.modifiers.slice(),this.fn)(t))throw null}},{key:"_testAsync",value:function(t){var n=this;return new Promise((function(e,r){u(n.modifiers.slice(),n.fn)(t).then((function(n){n?e(t):r(null)})).catch((function(t){return r(t)}))}))}}]),e}();function i(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"simple";return"object"==typeof t?t[n]:t}function o(t,n){if(t.length){var e=t.shift(),r=o(t,n);return e.perform(r)}return i(n)}function u(t,n){if(t.length){var e=t.shift(),r=u(t,n);return e.performAsync(r)}return function(t){return Promise.resolve(i(n,"async")(t))}}var c=function n(e,r,i){t(this,n),this.name=e,this.perform=r,this.performAsync=i},s=function(n){function r(n,i,o,u){t(this,r);for(var c=arguments.length,s=Array(c>4?c-4:0),a=4;a<c;a++)s[a-4]=arguments[a];var f=e(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,s));return Error.captureStackTrace&&Error.captureStackTrace(f,r),f.rule=n,f.value=i,f.cause=o,f.target=u,f}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n)}(r,Error),r}(),a=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t(this,e),this.chain=n,this.nextRuleModifiers=r}return n(e,[{key:"_applyRule",value:function(t,n){var e=this;return function(){for(var i=arguments.length,o=Array(i),u=0;u<i;u++)o[u]=arguments[u];return e.chain.push(new r(n,t.apply(e,o),o,e.nextRuleModifiers)),e.nextRuleModifiers=[],e}}},{key:"_applyModifier",value:function(t,n){return this.nextRuleModifiers.push(new c(n,t.simple,t.async)),this}},{key:"_clone",value:function(){return new e(this.chain.slice(),this.nextRuleModifiers.slice())}},{key:"test",value:function(t){return this.chain.every((function(n){return n._test(t)}))}},{key:"testAll",value:function(t){var n=[];return this.chain.forEach((function(e){try{e._check(t)}catch(r){n.push(new s(e,t,r))}})),n}},{key:"check",value:function(t){this.chain.forEach((function(n){try{n._check(t)}catch(e){throw new s(n,t,e)}}))}},{key:"testAsync",value:function(t){var n=this;return new Promise((function(e,r){f(t,n.chain.slice(),e,r)}))}}]),e}();function f(t,n,e,r){if(n.length){var i=n.shift();i._testAsync(t).then((function(){f(t,n,e,r)}),(function(n){r(new s(i,t,n))}))}else e(t)}function l(){return p(new a)}var h={};function p(t){return new Proxy(t,{get:function(n,e){if(e in n)return n[e];var r=p(t._clone());return e in g?r._applyModifier(g[e],e):e in h?r._applyRule(h[e],e):e in m?r._applyRule(m[e],e):void 0}})}l.extend=function(t){Object.assign(h,t)},l.clearCustomRules=function(){h={}};var g={not:{simple:function(t){return function(n){return!t(n)}},async:function(t){return function(n){return Promise.resolve(t(n)).then((function(t){return!t})).catch((function(t){return!0}))}}},some:{simple:function(t){return function(n){return y(n).some((function(n){try{return t(n)}catch(t){return!1}}))}},async:function(t){return function(n){return Promise.all(y(n).map((function(n){try{return t(n).catch((function(t){return!1}))}catch(t){return!1}}))).then((function(t){return t.some(Boolean)}))}}},every:{simple:function(t){return function(n){return y(n).every(t)}},async:function(t){return function(n){return Promise.all(y(n).map(t)).then((function(t){return t.every(Boolean)}))}}}};function y(t){return"string"==typeof t?t.split(""):t}var m={equal:function(t){return function(n){return n==t}},exact:function(t){return function(n){return n===t}},number:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function(n){return"number"==typeof n&&(t||isFinite(n))}},integer:function(){return function(t){return(Number.isInteger||v)(t)}},numeric:function(){return function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},string:function(){return d("string")},boolean:function(){return d("boolean")},undefined:function(){return d("undefined")},null:function(){return d("null")},array:function(){return d("array")},object:function(){return d("object")},instanceOf:function(t){return function(n){return n instanceof t}},pattern:function(t){return function(n){return t.test(n)}},lowercase:function(){return function(t){return/^([a-z]+\s*)+$/.test(t)}},uppercase:function(){return function(t){return/^([A-Z]+\s*)+$/.test(t)}},vowel:function(){return function(t){return/^[aeiou]+$/i.test(t)}},consonant:function(){return function(t){return/^(?=[^aeiou])([a-z]+)$/i.test(t)}},first:function(t){return function(n){return n[0]==t}},last:function(t){return function(n){return n[n.length-1]==t}},empty:function(){return function(t){return 0===t.length}},length:function(t,n){return function(e){return e.length>=t&&e.length<=(n||t)}},minLength:function(t){return function(n){return n.length>=t}},maxLength:function(t){return function(n){return n.length<=t}},negative:function(){return function(t){return t<0}},positive:function(){return function(t){return t>=0}},between:function(t,n){return function(e){return e>=t&&e<=n}},range:function(t,n){return function(e){return e>=t&&e<=n}},lessThan:function(t){return function(n){return n<t}},lessThanOrEqual:function(t){return function(n){return n<=t}},greaterThan:function(t){return function(n){return n>t}},greaterThanOrEqual:function(t){return function(n){return n>=t}},even:function(){return function(t){return t%2==0}},odd:function(){return function(t){return t%2!=0}},includes:function(t){return function(n){return~n.indexOf(t)}},schema:function(t){return n=t,{simple:function(t){var e=[];if(Object.keys(n).forEach((function(r){var i=n[r];try{i.check((t||{})[r])}catch(t){t.target=r,e.push(t)}})),e.length>0)throw e;return!0},async:function(t){var e=[],r=Object.keys(n).map((function(r){return n[r].testAsync((t||{})[r]).catch((function(t){t.target=r,e.push(t)}))}));return Promise.all(r).then((function(t){if(e.length>0)throw e;return!0}))}};var n},passesAnyOf:function(){for(var t=arguments.length,n=Array(t),e=0;e<t;e++)n[e]=arguments[e];return function(t){return n.some((function(n){return n.test(t)}))}},optional:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(e){return n&&"string"==typeof e&&""===e.trim()||null!=e&&t.check(e),!0}}};function d(t){return function(n){return Array.isArray(n)&&"array"===t||null===n&&"null"===t||typeof n===t}}function v(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}var w=l;w().string().length(0,0);const b=w().numeric().integer();b.greaterThanOrEqual(1),b.greaterThanOrEqual(0);var E=class{constructor(){}get isBlank(){return w().string().empty()}get isNotBlank(){return w().string().minLength(1)}get commonRule(){return w().numeric().integer().positive()}get isPosiInt(){return this.commonRule.greaterThanOrEqual(1)}get isPosiIntAnd0(){return this.commonRule}get isNumericStr(){return w().string().pattern(/\d+/)}hasMapKeys(t,n){if(t instanceof Map&&Array.isArray(n))return n.every((n=>t.has(n)));throw new TypeError("引数がMapとArrayでない")}isValuesPosiInt(t){return Array.from(t.values()).every((t=>this.isPosiIntAnd0.test(t)))}};const _=new E;const k=new E,I=new class{parseInput(t){if(_.isNumericStr.test(t))return parseInt(t,10);throw new Error("引数が数値で構成された文字列でない")}allowBlank(t){return _.isBlank.test(t)?null:this.parseInput(t)}};const P=new E;var M=function(t){return(new DOMParser).parseFromString(t,"text/html").body.firstElementChild};new class{constructor(){const t=document.getElementById("js-error");document.getElementById("js-form").addEventListener("submit",(n=>{try{for(n.preventDefault(),t.classList.add("error--invisible");t.firstChild;)t.removeChild(t.firstChild);const e=new class{constructor(){const t=new class{constructor(){const t=["span","goal","total","approx"],n=new Map;for(const e of t)k.isNotBlank.test(document.getElementById(`js-input_${e}`).value)&&n.set(e,I.parseInput(document.getElementById(`js-input_${e}`).value));return n}};if(function(t){let n="";switch(t.size){case 3:n=k.isPosiInt.test(t.get("span"))&&k.isPosiInt.test(t.get("goal"))&&k.isPosiIntAnd0.test(t.get("total"));break;case 4:n=k.isPosiInt.test(t.get("span"))&&k.isPosiInt.test(t.get("goal"))&&k.isPosiIntAnd0.test(t.get("total"))&&k.isPosiInt.test(t.get("approx"));break;default:throw new RangeError("Map.sizeは3か4でなければならない")}return n}(t))return t;throw new Error("入力内容が正しくない")}},r=function(t){if(t instanceof Map&&(3===t.size||4===t.size)&&P.hasMapKeys(t,["span","goal","total"])&&P.isValuesPosiInt(t)){const n=t.get("goal")-t.get("total"),e=Math.ceil(n/t.get("span")),r=new Map([["remain",n],["dailyGoal",e]]);if(4===t.size){const e=Math.ceil(n/t.get("approx")),i=Math.ceil(e/t.get("span"));r.set("remainBattle",e),r.set("dailyBattle",i)}return r}throw t instanceof Map?3!==t.size||4!==t.size?new RangeError("Map.sizeが3か4でない"):new Error("何かがダメ"):new TypeError("引数がMapでない")}(e);new class{constructor(t){if(!(t instanceof Map)||2!==t.size&&4!==t.size)throw new Error("引数はMap、かつsizeが2か4でなければならない");{const n=["remain","dailyGoal"];for(const e of n)document.getElementById(`js-output_${e}`).textContent=t.get(e).toLocaleString();if(4===t.size){const n=["remainBattle","dailyBattle"];for(const e of n)document.getElementById(`js-output_${e}`).textContent=t.get(e).toLocaleString()}const e=document.getElementById("js-result");e.classList.remove("horizontalCard--invisible","animate__animated","animate__fadeIn"),e.classList.add("animate__animated","animate__fadeIn")}}}(r),new class{constructor(t,n){google.charts.load("current",{packages:["corechart","bar"],language:"ja"}),google.charts.setOnLoadCallback((function(){const e=google.visualization.arrayToDataTable([["進捗","獲得済",{role:"style"},"残り",{role:"style"}],["",t,"#00c853",n,"#EEEEEE"]]);new google.visualization.BarChart(document.getElementById("js-output_meter")).draw(e,{axisTitlesPosition:"none",chartArea:{backgroundColor:"white",left:0,top:0,width:"100%",height:"100%"},hAxis:{format:"percent",maxValue:1,minValue:0,ticks:[],baselineColor:"white"},height:50,legend:{position:"none"},isStacked:"percent"})}))}}(e.get("total"),r.get("remain"))}catch(n){console.error(n),t.classList.remove("error--invisible"),t.appendChild(M('<h1 class="error__title">！エラーが発生しました。</h1>')),t.appendChild(M("<p>入力内容を確認してください。<br>半角数字のみ入力できます。</p>"))}}))}}}();